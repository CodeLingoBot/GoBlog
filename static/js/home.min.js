function fixHeader(){var t=$("#nav"),e=t.offset().top;console.log(e),$(window).scroll(function(){e<$(this).scrollTop()?t.addClass("fixed").removeClass("text-center"):t.removeClass("fixed").addClass("text-center")})}function topButton(){var t=$("#nav").offset().top,e=$("#go-top");$(window).scroll(function(){t<$(this).scrollTop()?e.removeClass("hide"):e.addClass("hide")}),e.on("click",function(){return $("body,html").animate({scrollTop:0},500),!1})}function renderMarkdown(){var t=$(".markdown");t.each(function(t,e){$(e).html(marked($(e).html().replace(/&gt;/g,">")))});var e=t.find("pre code");e.length&&($("<link>").attr({rel:"stylesheet",type:"text/css",href:"/static/css/highlight.css"}).appendTo("head"),$.getScript("/static/lib/highlight.min.js",function(){e.each(function(t,e){hljs.highlightBlock(e)})}))}function initComment(){var t=$("#comment-list");if(t.length&&(localStorage.getItem("comment-author")&&($("#comment-author").val(localStorage.getItem("comment-author")),$("#comment-email").val(localStorage.getItem("comment-email")),$("#comment-url").val(localStorage.getItem("comment-url")),$("#comment-avatar").attr("src",localStorage.getItem("comment-avatar")),$(".c-avatar").removeClass("null")),$("#comment-content").on("focus",function(){$(".c-avatar").hasClass("null")&&($(".c-avatar-field").remove(),$(".c-info-fields").removeClass("hide"))}),$(".not-me").on("click",function(){return $(".c-avatar-field").remove(),$(".c-info-fields").removeClass("hide"),!1}),$("#comment-show").on("click",".enable",function(){$("#comment-show").remove(),$("#comment-form").removeClass("hide")}),$("#comment-form").ajaxForm(function(e){if(e.res){localStorage.setItem("comment-author",$("#comment-author").val()),localStorage.setItem("comment-email",$("#comment-email").val()),localStorage.setItem("comment-url",$("#comment-url").val()),localStorage.setItem("comment-avatar",e.comment.avatar);var o=$($("#comment-tpl").html());o.find(".c-avatar").attr("src",e.comment.avatar).attr("alt",e.comment.author),o.find(".c-author").attr("href",e.comment.url).text(e.comment.author),o.find(".c-reply").attr("rel",e.comment.id),o.find(".c-content").html(e.comment.content),e.comment.parent_md?o.find(".c-p-md").html(marked(e.comment.parent_md)):o.find(".c-p-md").remove(),o.attr("id","comment-"+e.comment.id),"approved"==e.comment.status&&o.find(".c-check").remove(),t.append(o),$(".cancel-reply").trigger("click"),$("#comment-content").val("")}else alert("提交失败!")}),t.on("click",".c-reply",function(){$(".reply-md").remove();var t=$(this).attr("rel"),e=$("#comment-"+t),o="> @"+e.find(".c-author").text()+"\n\n";o+="> "+e.find(".c-content").html()+"\n",$("#comment-content").before('<div class="reply-md markdown">'+marked(o)+"</div>"),$("#comment-parent").val(t),$("#comment-show").length&&$("#comment-show .enable").trigger("click"),$(".cancel-reply").show();var n=$("#comment-form").offset().top;return $("body,html").animate({scrollTop:n},500),!1}),$(".cancel-reply").on("click",function(){return $(".reply-md").remove(),$("#comment-parent").val(0),$(this).hide(),!1}),t.hasClass("comment-pager-true"))){var e=!1,o=0,n=parseInt(t.data("page"));if(t.find(".comment").each(function(t,a){t>=n&&!e&&(e=!0),o=parseInt(t/n+1),$(a).addClass("comment-index-"+o).hide()}),!e)return $(".comment").show(),void 0;for(var a=['<div id="comment-list-pager" class="pager">'],m=1;o>=m;m++)m!=o?a.push('<li class="item"><a href="#">'+m+"</a></li>"):a.push('<li class="item current"><a href="#">'+m+"</a></li>");a.push("</div>"),$("#comment-title").after(a.join("")),$(".comment-index-"+o).show();var c=$("#comment-list-pager");c.on("click","a",function(t){return $(".comment").hide(),console.log(".comment-index-"+$(t.target).text()),$(".comment-index-"+$(t.target).text()).show(),c.find(".current").removeClass("current"),$(t.target).parent().addClass("current"),!1})}}$(document).ready(function(){topButton(),renderMarkdown(),initComment()});